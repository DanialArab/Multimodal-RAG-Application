Parameters are updated using stochastic gradient ascent where gradients are computed by differenti- ating the lower bound estimator ∇θ,φL(θ,φ;X) (see algorithm 1), plus a small weight decay term corresponding to a prior p(θ) = N(0,I). Optimization of this objective is equivalent to approxi- mate MAP estimation, where the likelihood gradient is approximated by the gradient of the lower bound.